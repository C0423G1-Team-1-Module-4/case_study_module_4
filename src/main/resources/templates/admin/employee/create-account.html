<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">

<head th:replace="admin/layout.html :: head(${title})">
    <title></title>
</head>

<body>

<!--*******************
    Preloader start
********************-->
<div id="preloader">
    <div class="loader">
        <svg class="circular" viewBox="25 25 50 50">
            <circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="3" stroke-miterlimit="10"/>
        </svg>
    </div>
</div>
<!--*******************
    Preloader end
********************-->


<!--**********************************
    Main wrapper start
***********************************-->
<div id="main-wrapper">

    <!--**********************************
        Nav header start
    ***********************************-->
    <div class="nav-header" th:replace="admin/layout.html :: nav-header"></div>
    <!--**********************************
        Nav header end
    ***********************************-->

    <!--**********************************
        Header start
    ***********************************-->
    <div class="header" th:replace="admin/layout.html :: header"></div>
    <!--**********************************
        Header end ti-comment-alt
    ***********************************-->

    <!--**********************************
        Sidebar start
    ***********************************-->
    <div class="nk-sidebar" th:replace="admin/layout.html :: nk-sidebar"></div>
    <!--**********************************
           Sidebar end
       ***********************************-->

    <!--**********************************
        Content body start
    ***********************************-->
    <!-- Display error message if login failed -->
    <div th:if="${param.error}" class="error-message" style="display: none">
        <p th:switch="${session['SPRING_SECURITY_LAST_EXCEPTION'].class.simpleName}" id="error-msg">
            <span th:case="BadCredentialsException">Invalid username or password.</span>
            <span th:case="LockedException">Your account has been locked due to too many failed attempts.</span>
            <span th:case="AccountExpiredException">Your account has expired.</span>
            <span th:case="DisabledException">Your must verify the account by email.</span>
            <span th:case="CredentialsExpiredException">Your credentials have expired.</span>
            <span th:case="default">An error occurred during login.</span>
        </p>
    </div>

    <div th:if="${param.success}">
        <span th:text="${param.success}" id="success" style="display: none"></span>
    </div>
    <div th:if="${success}">
        <span th:text="${success}" id="success" style="display: none"></span>
    </div>

    <div th:if="${param.fail}">
        <span th:text="${param.fail}" id="fail" style="display: none"></span>
    </div>
    <div th:if="${fail}">
        <span th:text="${fail}" id="fail" style="display: none"></span>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            let success = document.getElementById("success").innerText;
            console.log(success)
            Swal.fire({
                title: success,
                icon: 'success',
                timer: 1500,
                timerProgressBar: true,
                showConfirmButton: false
            });
        });

    </script>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            let fail = document.getElementById("fail").innerText;
            console.log(fail)
            Swal.fire({
                title: fail,
                icon: 'error',
                timer: 1500,
                timerProgressBar: true,
                showConfirmButton: false
            });
        });
    </script>
    <div class="content-body">

        <div class="row page-titles mx-0">
            <div class="col p-md-0">
                <ol class="breadcrumb">
                    <li class="breadcrumb-item"><a href="javascript:void(0)">Dashboard</a></li>
                    <li class="breadcrumb-item active"><a href="javascript:void(0)">Home</a></li>
                </ol>
            </div>
        </div>
        <!-- row -->
        <div class="container-fluid">
            <div class="row justify-content-center">
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-body">
                            <div class="form-validation">
                                <form class="form-valide" action="/admins/employee/createAccount" method="post"
                                      th:object="${accountDto}"
                                >
                                    <div class="form-group row">
                                        <label class="col-lg-4 col-form-label" for="form2Example18">Username<span
                                                class="text-danger">*</span>
                                        </label>
                                        <div class="col-lg-6">
                                            <input type="text" class="form-control" id="form2Example18"
                                                   name="username"
                                                   aria-describedby="employeeNameValid"
                                                   style="background-color: white; color: black"
                                                   th:field="*{username}" placeholder="Enter a username.." required>
                                            <div id="employeeNameValid" style="color: red"
                                                 th:if="${#fields.hasErrors('username')}"
                                                 th:errors="*{username}" class="form-text"></div>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label class="col-lg-4 col-form-label" for="form2Example4">Email
                                            <span
                                                    class="text-danger">*</span>
                                        </label>
                                        <div class="col-lg-6">
                                            <input
                                                    type="email"
                                                    id="form2Example4"
                                                    class="form-control"
                                                    name="email"
                                                    th:field="*{email}"
                                                    style="background-color: white; color: black"
                                            />
                                            <span style="color: red" th:if="${#fields.hasErrors('email')}"
                                                  th:errors="*{email}"></span>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label class="col-lg-4 col-form-label" for="form2Example5">Password<span
                                                class="text-danger">*</span>
                                        </label>
                                        <div class="col-lg-6">
                                            <input
                                                    type="password"
                                                    id="form2Example5"
                                                    class="form-control"
                                                    name="password"
                                                    th:field="*{password}"
                                                    style="background-color: white; color: black"
                                            />
                                            <span style="color: red" th:if="${#fields.hasErrors('password')}"
                                                  th:errors="*{password}"></span>
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label class="col-lg-4 col-form-label" for="form2Example6"
                                        >Re-enter password<span
                                                class="text-danger">*</span>
                                        </label>
                                        <div class="col-lg-6">
                                            <input
                                                    type="password"
                                                    id="form2Example6"
                                                    class="form-control"
                                                    name="password1"
                                                    onkeyup="checkRPW()"
                                            />
                                            <span style="color: red" id="message"></span>
                                        </div>
                                    </div>
                                    <!-- Submit button -->
                                    <div class="form-group row">
                                        <div class="col-lg-8 ml-auto">
                                            <button type="submit" class="btn btn-primary" id="signUp">Register</button>
                                            <a href="/admins/employee" role="button" class="btn btn-primary">Back to list</a>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- #/ container -->
</div>
<!--**********************************
    Content body end
***********************************-->


<!--**********************************
    Footer start
***********************************-->
<div class="footer">
    <div class="copyright">
        <p>Copyright &copy; Designed & Developed by <a href="https://themeforest.net/user/quixlab">Quixlab</a> 2018
        </p>
    </div>
</div>
<!--**********************************
    Footer end
***********************************-->
</div>
<!--**********************************
    Main wrapper end
***********************************-->

<!--**********************************
    Scripts
***********************************-->
<div th:replace="admin/layout.html :: js"></div>
<script th:inline="javascript">
    // Check if the URL contains the error parameter
    console.log(window.location.search);
    console.log(document.title);
    if (window.location.search.includes('error=true')) {
        // Remove the error parameter from the URL
        const newUrl = window.location.href.replace('?error=true', '');
        // Modify the URL without reloading the page
        window.history.replaceState({}, document.title, newUrl);
    }
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
    const signUpButton = document.getElementById("signUp");
    const container = document.getElementById("container");

    signUpButton.addEventListener("click", () => {
        container.classList.add("right-panel-active");
    });

    signInButton.addEventListener("click", () => {
        container.classList.remove("right-panel-active");
    });

    function checkRPW() {
        let pw = document.getElementById("form2Example5").value;
        let rpw = document.getElementById("form2Example6").value;
        let message = document.getElementById("message");
        let singUpButton = document.getElementById("signUp");
        singUpButton.disabled = false;
        if (pw.length >= 6) {
            if (pw === rpw) {
                message.textContent = "password ok";
                // document.getElementById('button').style.display = 'block';
                message.style.color = "green";
                singUpButton.disabled = false;
            } else {
                message.textContent = "Password not match.";
                message.style.color = "#C71010FF"
                singUpButton.disabled = true;
                // document.getElementById('button').style.display = 'none';
                let tabRegister = document.getElementById("tab-register");
                tabRegister.click();
            }
        } else {
            message.textContent = "Password must be at least 6 characters";
            message.style.color = "#C71010FF";
            singUpButton.disabled = true;
            // document.getElementById('button').style.display = 'none';
        }
    }

    // back to register tab
    document.addEventListener('DOMContentLoaded', function () {
        let fail = document.getElementById("fail").innerText;
        if (fail != null) {
            const tabRegister = document.getElementById("tab-register");
            tabRegister.click();
        }
    });

    document.addEventListener("DOMContentLoaded", function () {
        let msg = document.getElementById("error-msg").innerText;
        // Display a SweetAlert when the document is ready
        Swal.fire({
            title: msg,
            icon: 'error',
            timer: 2000, // Time in milliseconds (2 seconds)
            timerProgressBar: true,
            showConfirmButton: false // Hide the "Confirm" button
        });
        //Change URL:
        const currentUrl = window.location.href;
        const cleanUrl = currentUrl.split('?')[0];
        history.replaceState(null, null, cleanUrl);
    });
</script>
<script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/7.7.0/firebase-storage.js"></script>
<script type="module" src="/js/configuration-firebase-thoi.js"></script>
<script type="module" src="/js/upload-file-thoi.js"></script>
</body>

</html>